{% extends "profile_base.html" %}
{% load static %}
{% load i18n %}

{% block profile_content %}

<div id="field">
  <h4 class="personal-title"><strong>学术领域选择</strong></h4>
  <hr class="personal-line"/>
  <h5><strong>通过选择学术领域缩小文章范围</strong><h5>
  <!-- <form style="margin-top:10px;width:500px;" action="{% url 'domain' %}" method="post">
    {% csrf_token %}
    <div class='form-group fixed-form'>
        {% for field in form %}
      <div class="fieldWrapper">
        {{ field.label_tag }}{{ field }}
        {{ field.errors }}
      </div>
    {% endfor %}
    </div>
    <button type="submit" class="btn field-select-btn">{% trans 'Save' %}</button>
  </form> -->
  <div id="tree"></div>
  <div id="result">sss</div>
</div>
{% endblock %}
{% block script %}
<script src="{% static 'js/bootstrap-treeview.min.js' %}"></script>
<script>
 $(function () {
    $.ajaxSetup({
        data: {csrfmiddlewaretoken: '{{ csrf_token }}' },
    });
    var tree = $.getJSON("{% url 'dept_tree' %}", '', function (data) {
        alert("124");
        $('#tree').treeview({
            data: data,
            level: 2,
            showTags: true,
            onNodeSelected: function (event, node) {
                $.post("../people/"+node.id, {}, function(data){
                    console.log(data);
                    $("#result").html(data);
                })
            }
        });
    });
});
</script>
{% if messages %}
  <script>
  $(document).ready(function () {
  {% for message in messages %}
    toastr.success('{{ message }}. &nbsp;&nbsp;&nbsp;&nbsp;<a href="{% url 'esoda' %}">开始搜搭</a>');
  {% endfor %}
  });
  </script>
{% endif %}
{% endblock %}
